<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ReceiptMapper">
  <sql id="search">
  <if test="pay_method != 'null'.toString()">
    <trim prefix=" and (" suffix=") ">
      pay_method = #{pay_method}
    </trim>
  </if>
  <if test="division == 0">
    <trim prefix=" and (" suffix=") ">
      division = #{division}
    </trim>
  </if>
</sql>
  <insert id="addrec" parameterType="ReceiptVO">
    insert into tbl_sell(sell_no, member_id, barcode, sell_qnt, pay_method, sell_date, discount_rate, receipt_no) 
    values(seq_sell_no.nextval, #{member_id}, #{barcode}, #{sell_qnt}, #{pay_method}, #{sell_date}, #{discount_rate}, #{receipt_no})
  </insert>
  <select id="rlist" parameterType="ReceiptVO" resultType="ReceiptVO">
  <![CDATA[
    select/*+INDEX_DESC(tbl_sell pk_sell)*/ sell_no, pay_method, sell_date, receipt_no, pname from tbl_sell where rownum > 0 
    ]]>
    <include refid="search"/>
    <![CDATA[
    and (sell_date between #{sell_date_s} and #{sell_date_e}) order by sell_no desc, pname
    ]]>
  </select>
  <select id="scraplist">
  	select scrap_no, barcode, pname, category, scrap_qnt, scrap_date from tbl_scrap where rownum > 0 
    and (scrap_date between #{sell_date_s} and #{sell_date_e}) order by scrap_no
  </select>
  <select id="rdetail" parameterType="java.lang.String" resultType="ReceiptVO">
    select * from tbl_sell where receipt_no = #{receipt_no}
  </select>
</mapper>